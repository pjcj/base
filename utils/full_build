#!/usr/bin/env zsh

# set -x

gobase() { cd ~/g/base || exit 1; }

gobase

source ~/.zplug/init.zsh
zplug clear
curl -SL https://raw.githubusercontent.com/docker/docker/master/contrib/completion/zsh/_docker \
    >| /home/pjcj/g/base/zsh/functions/_docker
rm -f ~/.zcompdump; compinit

~/.tmux/plugins/tpm/bindings/clean_plugins
~/.tmux/plugins/tpm/bindings/install_plugins
~/.tmux/plugins/tpm/scripts/update_plugin_prompt_handler.sh all

# for neovim:
if [ "$ISOSX" ]; then
    brew update
    brew upgrade
    pip3=pip
    npm -g install instant-markdown-d
else
    pip3=pip3
    sudo aptitude -y install \
        python-pip python-setuptools \
        python3-pip python3-setuptools
    sudo aptitude -y install golang
    sudo npm -g install instant-markdown-d
fi
$pip3 install --upgrade --user neovim vim-vint proselint
pip install --upgrade --user git+git://github.com/powerline/powerline

# urlwatch
$pip3 install --upgrade --user pyyaml minidb requests keyring chump urlwatch

$EDITOR -c PlugUpgrade -c qa
# $EDITOR -c PlugClean   -c qa
$EDITOR -c PlugInstall -c qa
$EDITOR -c PlugUpdate  -c qa

$EDITOR -c UnicodeDownload -c qa

gobase
# perl -pi -e "s/if has\('gui_running'\)\K$/ || (has('nvim') && &termguicolors)/" \
            # .vim/plugged/vim-interestingwords/plugin/interestingwords.vim

command go get -u github.com/motemen/ghq

build_all
